import * as RgbColor from '../color/rgb';

const COLOR_TABLE: (RgbColor.Hex | null)[] = [
	// 00
	0xffeeff, 0xff99aa, 0xee5599,
	0xff66aa, 0xff0066, 0xbb4477,
	0xcc0055, 0x990033, 0x552233,
	null, null, null, null, null, null,
	0xffffff,
	// 10
	0xffbbcc, 0xff7777, 0xdd3311,
	0xff5544, 0xff0000, 0xcc6666,
	0xbb4444, 0xbb0000, 0x882222,
	null, null, null, null, null, null,
	0xeeeeee,
	// 20
	0xddccbb, 0xffcc66, 0xdd6622,
	0xffaa22, 0xff6600, 0xbb8855,
	0xdd4400, 0xbb4400, 0x663311,
	null, null, null, null, null, null,
	0xdddddd,
	// 30
	0xffeedd, 0xffddcc, 0xffccaa,
	0xffbb88, 0xffaa88, 0xdd8866,
	0xbb6644, 0x995533, 0x884422,
	null, null, null, null, null, null,
	0xcccccc,
	// 40
	0xffccff, 0xee88ff, 0xcc66dd,
	0xbb88cc, 0xcc00ff, 0x996699,
	0x8800aa, 0x550077, 0x330044,
	null, null, null, null, null, null,
	0xbbbbbb,
	// 50
	0xffbbff, 0xff99ff, 0xdd22bb,
	0xff55ee, 0xff00cc, 0x885577,
	0xbb0099, 0x880066, 0x550044,
	null, null, null, null, null, null,
	0xaaaaaa,
	// 60
	0xddbb99, 0xccaa77, 0x774433,
	0xaa7744, 0x993300, 0x773322,
	0x552200, 0x331100, 0x221100,
	null, null, null, null, null, null,
	0x999999,
	// 70
	0xffffcc, 0xffff77, 0xdddd22,
	0xffff00, 0xffdd00, 0xccaa00,
	0x999900, 0x887700, 0x555500,
	null, null, null, null, null, null,
	0x888888,
	// 80
	0xddbbff, 0xbb99ee, 0x6633cc,
	0x9955ff, 0x6600ff, 0x554488,
	0x440099, 0x220066, 0x221133,
	null, null, null, null, null, null,
	0x777777,
	// 90
	0xbbbbff, 0x8899ff, 0x3333aa,
	0x3355ee, 0x0000ff, 0x333388,
	0x0000aa, 0x111166, 0x000022,
	null, null, null, null, null, null,
	0x666666,
	// a0
	0x99eebb, 0x66cc77, 0x226611,
	0x44aa33, 0x008833, 0x557755,
	0x225500, 0x113322, 0x002211,
	null, null, null, null, null, null,
	0x555555,
	// b0
	0xddffbb, 0xccff88, 0x88aa55,
	0xaadd88, 0x88ff00, 0xaabb99,
	0x66bb00, 0x559900, 0x336600,
	null, null, null, null, null, null,
	0x444444,
	// c0
	0xbbddff, 0x77ccff, 0x335599,
	0x6699ff, 0x1177ff, 0x4477aa,
	0x224477, 0x002277, 0x001144,
	null, null, null, null, null, null,
	0x333333,
	// d0
	0xaaffff, 0x55ffff, 0x0088bb,
	0x55bbcc, 0x00ccff, 0x4499aa,
	0x006688, 0x004455, 0x002233,
	null, null, null, null, null, null,
	0x222222,
	// e0
	0xccffee, 0xaaeedd, 0x33ccaa,
	0x55eebb, 0x00ffcc, 0x77aaaa,
	0x00aa99, 0x008877, 0x004433,
	null, null, null, null, null, null,
	0x000000,
	// f0
	0xaaffaa, 0x77ff77, 0x66dd44,
	0x00ff00, 0x22dd22, 0x55bb55,
	0x00bb00, 0x008800, 0x224422,
	null, null, null, null, null, null,
	null,
];

export function getNearestColorId(rgbHex: RgbColor.Hex): number {
	let minDist = Number.MAX_VALUE;
	let result = -1;

	const rgbComps = RgbColor.componentsFromHex(rgbHex);
	COLOR_TABLE.forEach((palHex, id) => {
		if (palHex === null) {
			return;
		}

		const palComps = RgbColor.componentsFromHex(palHex);
		const dist = RgbColor.getDistance(rgbComps, palComps);
		if (dist < minDist) {
			result = id;
			minDist = dist;
		}
	});

	return result;
}

export function getColor(colorId: number): RgbColor.Hex | null {
	return COLOR_TABLE[colorId];
}